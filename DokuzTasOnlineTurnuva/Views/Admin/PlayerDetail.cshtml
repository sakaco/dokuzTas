@{
    ViewData["Title"] = "Oyuncu DetaylarÄ±";
    var user = ViewBag.User as DokuzTasOnlineTurnuva.Models.ApplicationUser;
    var stats = ViewBag.Stats as List<DokuzTasOnlineTurnuva.Models.PlayerStatistic>;
    var matches = ViewBag.Matches as List<DokuzTasOnlineTurnuva.Models.Match>;
}

<div class="min-h-screen p-4 md:p-8">
    <div class="max-w-7xl mx-auto">
        <div class="bg-white rounded-3xl shadow-2xl p-6 md:p-12 mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-center text-gray-800 mb-8">
                ğŸ‘¤ @user?.UserName - DetaylÄ± Rapor
            </h1>
            
            <div class="grid grid-cols-2 md:grid-cols-5 gap-4 mb-8">
                <div class="bg-gradient-to-br from-blue-100 to-blue-200 p-6 rounded-2xl text-center">
                    <div class="text-3xl md:text-4xl mb-2">ğŸ¯</div>
                    <div class="text-2xl md:text-3xl font-bold text-blue-800">@user?.Points</div>
                    <div class="text-blue-600">Puan</div>
                </div>
                
                <div class="bg-gradient-to-br from-green-100 to-green-200 p-6 rounded-2xl text-center">
                    <div class="text-3xl md:text-4xl mb-2">ğŸ“ˆ</div>
                    <div class="text-2xl md:text-3xl font-bold text-green-800">@user?.Averaj</div>
                    <div class="text-green-600">Averaj</div>
                </div>
                
                <div class="bg-gradient-to-br from-purple-100 to-purple-200 p-6 rounded-2xl text-center">
                    <div class="text-3xl md:text-4xl mb-2">ğŸ®</div>
                    <div class="text-2xl md:text-3xl font-bold text-purple-800">@user?.TotalMatches</div>
                    <div class="text-purple-600">Toplam</div>
                </div>
                
                <div class="bg-gradient-to-br from-yellow-100 to-yellow-200 p-6 rounded-2xl text-center">
                    <div class="text-3xl md:text-4xl mb-2">ğŸ†</div>
                    <div class="text-2xl md:text-3xl font-bold text-yellow-800">@user?.WonMatches</div>
                    <div class="text-yellow-600">KazanÄ±lan</div>
                </div>
                
                <div class="bg-gradient-to-br from-red-100 to-red-200 p-6 rounded-2xl text-center">
                    <div class="text-3xl md:text-4xl mb-2">âŒ</div>
                    <div class="text-2xl md:text-3xl font-bold text-red-800">@user?.LostMatches</div>
                    <div class="text-red-600">Kaybedilen</div>
                </div>
            </div>
            
            @if (user?.IsBlacklisted == true)
            {
                <div class="bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded mb-6">
                    <p class="font-bold">ğŸš« Bu oyuncu kara listede</p>
                </div>
            }
        </div>
        
        <div class="bg-white rounded-3xl shadow-2xl p-6 md:p-12 mb-8">
            <h2 class="text-2xl md:text-3xl font-bold text-gray-800 mb-6">ğŸ“… GÃ¼nlÃ¼k Ä°statistikler</h2>
            <div class="overflow-x-auto">
                <table class="w-full">
                    <thead>
                        <tr class="border-b-2 border-gray-200">
                            <th class="p-3 text-left">Tarih</th>
                            <th class="p-3 text-center">Hafta</th>
                            <th class="p-3 text-center">MaÃ§</th>
                            <th class="p-3 text-center">Puan</th>
                            <th class="p-3 text-center">Averaj</th>
                            <th class="p-3 text-center">Bonus</th>
                            <th class="p-3 text-center">Ã‡Ä±ktÄ±</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (stats != null)
                        {
                            @foreach (var stat in stats)
                            {
                                <tr class="border-b border-gray-100 hover:bg-gray-50">
                                    <td class="p-3">@stat.Date.ToString("dd.MM.yyyy")</td>
                                    <td class="p-3 text-center">@stat.WeekNumber</td>
                                    <td class="p-3 text-center">@stat.MatchesPlayed</td>
                                    <td class="p-3 text-center font-bold text-blue-600">@stat.Points</td>
                                    <td class="p-3 text-center font-bold text-green-600">@stat.Averaj</td>
                                    <td class="p-3 text-center">
                                        @if (stat.CompletedDailyMatches)
                                        {
                                            <span class="bg-green-100 text-green-800 px-2 py-1 rounded">âœ“ @stat.ConsecutiveDays gÃ¼n</span>
                                        }
                                    </td>
                                    <td class="p-3 text-center">
                                        @if (stat.QuitMatch)
                                        {
                                            <span class="text-red-600">âŒ</span>
                                        }
                                    </td>
                                </tr>
                            }
                        }
                    </tbody>
                </table>
            </div>
        </div>
        
        <div class="bg-white rounded-3xl shadow-2xl p-6 md:p-12">
            <h2 class="text-2xl md:text-3xl font-bold text-gray-800 mb-6">ğŸ¯ MaÃ§ GeÃ§miÅŸi</h2>
            <div class="space-y-4">
                @if (matches != null)
                {
                    @foreach (var match in matches)
                    {
                        var isPlayer1 = match.Player1Id == user?.Id;
                        var opponent = isPlayer1 ? match.Player2 : match.Player1;
                        var won = match.WinnerId == user?.Id;
                        var quit = (isPlayer1 && match.Player1Quit) || (!isPlayer1 && match.Player2Quit);
                        
                        <div class="@(won ? "bg-green-50" : "bg-red-50") p-4 rounded-xl border-2 @(won ? "border-green-200" : "border-red-200")">
                            <div class="flex justify-between items-center">
                                <div>
                                    <span class="text-lg font-bold">@user?.UserName</span>
                                    <span class="mx-2">vs</span>
                                    <span class="text-lg font-bold">@opponent?.UserName</span>
                                    @if (quit)
                                    {
                                        <span class="ml-2 text-red-600">âŒ Oyundan Ã‡Ä±ktÄ±</span>
                                    }
                                </div>
                                <div class="text-right">
                                    <div class="text-2xl">@(won ? "ğŸ†" : "âŒ")</div>
                                    <div class="text-sm text-gray-600">@match.StartTime.ToString("dd.MM HH:mm")</div>
                                    <div class="text-xs text-gray-500">
                                        @switch (match.MatchType)
                                        {
                                            case DokuzTasOnlineTurnuva.Models.MatchType.League:
                                                <span>Lig</span>
                                                break;
                                            case DokuzTasOnlineTurnuva.Models.MatchType.QuarterFinal:
                                                <span>Ã‡eyrek Final</span>
                                                break;
                                            case DokuzTasOnlineTurnuva.Models.MatchType.SemiFinal:
                                                <span>YarÄ± Final</span>
                                                break;
                                            case DokuzTasOnlineTurnuva.Models.MatchType.Final:
                                                <span>Final</span>
                                                break;
                                        }
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                }
            </div>
        </div>
    </div>
</div>
